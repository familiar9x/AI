# ========== RAG core ==========
# Security (legacy, deprecated in v3 - use OIDC)
API_KEY=change_me_long_random

# Qdrant
QDRANT_URL=http://qdrant:6333
QDRANT_COLLECTION=internal_docs

# vLLM OpenAI-compatible endpoint
LLM_BASE_URL=http://vllm:8000/v1
LLM_MODEL=Qwen2.5-7B-Instruct

# RAG tuning
EMBED_MODEL=sentence-transformers/bge-m3
CHUNK_SIZE=900
CHUNK_OVERLAP=150
TOP_K=6

# OCR settings
# Language for OCR: eng (English), vie (Vietnamese), or eng+vie for both
OCR_LANG=eng+vie
OCR_DPI=250
PDF_TEXT_MIN_CHARS=80

# Cache inside container
CACHE_DIR=/app/.cache

# ========== OIDC (Keycloak external) v3 ==========
# Issuer URL của realm (public URL hoặc internal URL mà oauth2-proxy/backend truy cập được)
OIDC_ISSUER=https://keycloak.company.local/realms/<REALM>
OIDC_AUDIENCE=rag-proxy

# Backend sẽ verify JWT theo issuer này
BACKEND_OIDC_ISSUER=https://keycloak.company.local/realms/<REALM>
BACKEND_OIDC_AUDIENCE=rag-proxy

# Admin group for /admin/* endpoints
ADMIN_GROUP=RAG-ADMINS

# ========== oauth2-proxy config v3 ==========
OAUTH2_PROXY_PROVIDER=keycloak-oidc
OAUTH2_PROXY_OIDC_ISSUER_URL=https://keycloak.company.local/realms/<REALM>
OAUTH2_PROXY_CLIENT_ID=rag-proxy
OAUTH2_PROXY_CLIENT_SECRET=<CLIENT_SECRET>
OAUTH2_PROXY_COOKIE_SECRET=<32-byte-base64>
OAUTH2_PROXY_COOKIE_SECURE=true
OAUTH2_PROXY_COOKIE_SAMESITE=lax
OAUTH2_PROXY_EMAIL_DOMAINS=*

OAUTH2_PROXY_HTTP_ADDRESS=0.0.0.0:4180

# pass token down to nginx/backend
OAUTH2_PROXY_PASS_ACCESS_TOKEN=true
OAUTH2_PROXY_SET_AUTHORIZATION_HEADER=true
OAUTH2_PROXY_SET_XAUTHREQUEST=true
